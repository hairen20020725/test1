# 表格单元格格式修复说明文档 📋

## 问题描述

### 原始问题

**现象**：
表格中出现了"适配主卧面积"这样的描述性文字，而不是具体的数值数据。

**示例**：
```markdown
| 房间名称 | 房间面积 | 空调型号 | 数量 |
|---------|---------|---------|------|
| 主卧 | 适配主卧面积 | 格力 KFR-35GW | 1台 |
```

**问题**：
- ❌ "适配主卧面积"不是具体数据
- ❌ 违反了表格格式规范
- ❌ 用户无法获取准确信息
- ❌ 表格失去了数据展示的意义

---

## 问题分析

### 根本原因

1. **AI理解偏差**
   - AI将表格单元格当作描述性文本区域
   - 没有严格按照表头要求填写
   - 使用了模糊的描述而非具体数据

2. **Prompt不够明确**
   - 之前的要求不够具体
   - 没有明确每列应该填写什么类型的数据
   - 没有提供正确和错误的对比示例

3. **缺少严格约束**
   - 没有明确禁止的内容列表
   - 没有强调"严格按照表头"的要求
   - 系统提示中的规范不够详细

### 类似问题

**其他可能出现的错误格式**：
- "根据客厅大小"
- "约30㎡"
- "适配XX面积"
- "根据需求"
- "推荐配置"
- "可选方案"

---

## 解决方案

### 核心原则

**表格单元格必须严格按照表头要求填写具体数据，不得使用任何描述性、解释性文字。**

### 实施策略

#### 1. 明确每列的填写规范

为每个表头列定义清晰的填写规则：

| 表头 | 填写规范 | 正确示例 | 错误示例 |
|------|---------|---------|---------|
| 房间名称 | 只写房间名称 | "客厅"、"主卧" | "适配XX"、"根据XX" |
| 房间面积 | 只写数值+单位 | "30㎡"、"18㎡" | "适配主卧面积"、"约30㎡" |
| 空调型号 | 只写完整型号 | "格力 KFR-72LW" | "格力（推荐）" |
| 数量 | 只写数字+单位 | "1台"、"2台" | "根据需求" |
| 制冷量 | 只写数值+单位 | "7200W" | "适配客厅" |
| 匹数 | 只写数值+单位 | "3匹"、"1.5匹" | "大功率" |
| 设备尺寸 | 只写具体尺寸 | "1850×700×320mm" | "标准尺寸" |
| 单价 | 只写价格 | "¥5,999" | "优惠价" |
| 小计 | 只写价格 | "¥5,999" | "合计" |

#### 2. 提供正确和错误示例

**正确示例**：
```markdown
| 房间名称 | 房间面积 | 空调型号 | 数量 | 制冷量(W) | 匹数 | 设备尺寸 | 单价 | 小计 |
|---------|---------|---------|------|----------|------|---------|------|------|
| 主卧 | 18㎡ | 格力 KFR-35GW | 1台 | 3500W | 1.5匹 | 950×320×215mm | ¥2,899 | ¥2,899 |
```

**错误示例**：
```markdown
| 房间名称 | 房间面积 | 空调型号 | 数量 | 制冷量(W) | 匹数 | 设备尺寸 | 单价 | 小计 |
|---------|---------|---------|------|----------|------|---------|------|------|
| 主卧 | 适配主卧面积 | 格力 KFR-35GW | 1台 | 3500W | 1.5匹 | 950×320×215mm | ¥2,899 | ¥2,899 |
| 主卧 | 约18㎡ | 格力 KFR-35GW（推荐） | 1台 | 3500W | 1.5匹 | 950×320×215mm | ¥2,899 | ¥2,899 |
```

#### 3. 明确禁止的内容

**严格禁止列表**：
- ❌ "适配主卧面积"、"根据客厅大小"
- ❌ "约30㎡"、"大约XX"
- ❌ 括号说明、备注
- ❌ "可选"、"建议"、"推荐"
- ❌ 任何非数据的描述性内容

---

## 技术实现

### 1. Prompt优化

**文件位置**：`src/pages/Home.tsx`

#### 表格格式要求部分

```typescript
**表格格式要求（严格执行）**：

**核心原则**：表格单元格必须严格按照表头要求填写具体数据，不得使用任何描述性、解释性文字。

**每列的填写规范**：
1. **房间名称**：只写房间名称（如"客厅"、"主卧"、"次卧1"），不得写"适配XX"、"根据XX"等
2. **房间面积**：只写具体数值+单位（如"30㎡"、"18㎡"），不得写"约XX"、"适配XX面积"等
3. **空调型号**：只写完整型号（如"格力 KFR-72LW"），必须是知识库中的真实产品
4. **数量**：只写数字+单位（如"1台"、"2台"），不得写"根据需求"等
5. **制冷量**：只写数值+单位（如"7200W"），必须与产品实际参数一致
6. **匹数**：只写数值+单位（如"3匹"、"1.5匹"），必须与产品实际参数一致
7. **设备尺寸**：只写具体尺寸（如"1850×700×320mm"），必须与产品实际参数一致
8. **单价**：只写价格（如"¥5,999"），使用产品的当前价格
9. **小计**：只写价格（如"¥5,999"），计算公式：单价×数量

**严格禁止的内容**：
- ❌ 禁止："适配主卧面积"、"根据客厅大小"、"约30㎡"
- ❌ 禁止：括号说明、备注、解释性文字
- ❌ 禁止："可选"、"建议"、"推荐"等词汇
- ❌ 禁止：任何非数据的描述性内容

**正确示例**：
| 主卧 | 18㎡ | 格力 KFR-35GW | 1台 | 3500W | 1.5匹 | 950×320×215mm | ¥2,899 | ¥2,899 |

**错误示例**：
| 主卧 | 适配主卧面积 | 格力 KFR-35GW | 1台 | 3500W | 1.5匹 | 950×320×215mm | ¥2,899 | ¥2,899 |
| 主卧 | 约18㎡ | 格力 KFR-35GW（推荐） | 1台 | 3500W | 1.5匹 | 950×320×215mm | ¥2,899 | ¥2,899 |
```

**特点**：
- 📋 逐列详细说明
- ✅ 提供正确示例
- ❌ 提供错误示例
- 🚫 明确禁止内容

### 2. 系统提示强化

**第7条核心方法更新**：

```typescript
7. **表格格式规范（严格执行）**：
   - 表格单元格必须严格按照表头要求填写具体数据
   - 严禁使用任何描述性、解释性文字（如"适配主卧面积"、"根据客厅大小"、"约30㎡"）
   - 房间面积必须写具体数值（如"18㎡"），不得写"适配XX面积"
   - 空调型号必须写完整型号（如"格力 KFR-35GW"），不得添加括号说明
   - 所有详细说明、备注必须放在表格外面单独说明
```

**强化要点**：
- 明确"严格执行"
- 列举具体的错误示例
- 强调"必须"和"不得"
- 提供正确的格式

---

## 对比分析

### 错误格式1：描述性文字

**错误**：
```markdown
| 主卧 | 适配主卧面积 | 格力 KFR-35GW | 1台 |
```

**问题**：
- ❌ "适配主卧面积"不是具体数据
- ❌ 用户无法知道实际面积
- ❌ 无法判断空调配置是否合理

**正确**：
```markdown
| 主卧 | 18㎡ | 格力 KFR-35GW | 1台 |
```

**优势**：
- ✅ 18㎡是具体数据
- ✅ 用户清楚知道房间面积
- ✅ 可以验证空调配置是否合理

### 错误格式2：模糊数值

**错误**：
```markdown
| 客厅 | 约30㎡ | 格力 KFR-72LW | 1台 |
```

**问题**：
- ❌ "约"表示不确定
- ❌ 可能是28㎡也可能是32㎡
- ❌ 影响空调功率判断

**正确**：
```markdown
| 客厅 | 30㎡ | 格力 KFR-72LW | 1台 |
```

**优势**：
- ✅ 30㎡是确定数值
- ✅ 清晰明确
- ✅ 便于计算和验证

### 错误格式3：括号说明

**错误**：
```markdown
| 主卧 | 18㎡ | 格力 KFR-35GW（推荐） | 1台 |
```

**问题**：
- ❌ 括号说明破坏表格简洁性
- ❌ 不符合表格数据格式
- ❌ 应该放在表格外说明

**正确**：
```markdown
| 主卧 | 18㎡ | 格力 KFR-35GW | 1台 |

**方案说明**：
- 主卧推荐使用格力 KFR-35GW，性价比高，适合18㎡空间
```

**优势**：
- ✅ 表格简洁清晰
- ✅ 说明独立展示
- ✅ 结构清晰合理

### 错误格式4：相对描述

**错误**：
```markdown
| 次卧 | 根据客厅大小 | 格力 KFR-26GW | 1台 |
```

**问题**：
- ❌ "根据客厅大小"不是面积数据
- ❌ 用户需要自己推算
- ❌ 完全不符合表格规范

**正确**：
```markdown
| 次卧 | 15㎡ | 格力 KFR-26GW | 1台 |
```

**优势**：
- ✅ 15㎡是具体数据
- ✅ 直接明了
- ✅ 符合表格规范

---

## 表格规范总结

### 核心要求

**1. 数据性**
- 表格单元格必须是数据
- 不是描述、不是说明、不是建议
- 只有具体的数值、型号、价格等

**2. 具体性**
- 必须是具体的、确定的数据
- 不能是"约"、"大约"、"适配"等模糊词
- 不能是"根据XX"、"基于XX"等相对描述

**3. 简洁性**
- 只包含数据本身
- 不添加任何修饰、说明、备注
- 保持表格的简洁和清晰

**4. 完整性**
- 每个单元格都必须填写
- 不能留空或使用占位符
- 必须是完整的数据

### 填写原则

**原则1：看表头填数据**
```
表头：房间面积
填写：18㎡（具体数值+单位）
不填：适配主卧面积、约18㎡、根据实际
```

**原则2：数据要确定**
```
确定：30㎡、格力 KFR-72LW、¥5,999
不确定：约30㎡、格力系列、优惠价
```

**原则3：说明放外面**
```
表格内：18㎡
表格外：主卧面积18㎡，南向采光好，建议使用1.5匹空调
```

**原则4：格式要统一**
```
面积：XX㎡
型号：品牌 型号
数量：X台
价格：¥X,XXX
```

---

## 实际应用示例

### 完整的正确表格

```markdown
### 3. 推荐方案

**方案类型**：风管机+分体式

**产品配置表**：

| 房间名称 | 房间面积 | 空调型号 | 数量 | 制冷量(W) | 匹数 | 设备尺寸 | 单价 | 小计 |
|---------|---------|---------|------|----------|------|---------|------|------|
| 客厅 | 30㎡ | 格力 KFR-72LW | 1台 | 7200W | 3匹 | 1850×700×320mm | ¥5,999 | ¥5,999 |
| 主卧 | 18㎡ | 格力 KFR-35GW | 1台 | 3500W | 1.5匹 | 950×320×215mm | ¥2,899 | ¥2,899 |
| 次卧1 | 15㎡ | 格力 KFR-26GW | 1台 | 2600W | 1匹 | 848×289×204mm | ¥2,399 | ¥2,399 |
| 次卧2 | 12㎡ | 格力 KFR-26GW | 1台 | 2600W | 1匹 | 848×289×204mm | ¥2,399 | ¥2,399 |
| 书房 | 10㎡ | 格力 KFR-26GW | 1台 | 2600W | 1匹 | 848×289×204mm | ¥2,399 | ¥2,399 |

**方案说明**：
- 客厅采用3匹空调，适配30㎡空间，制冷效果好
- 主卧使用1.5匹空调，18㎡空间舒适度高
- 次卧和书房使用1匹空调，经济实用
- 所有产品均为格力品牌，质量可靠，售后有保障
```

**特点**：
- ✅ 表格内全是具体数据
- ✅ 每个单元格都符合表头要求
- ✅ 说明文字放在表格外
- ✅ 结构清晰，易于阅读

### 常见错误对照表

| 错误类型 | 错误示例 | 正确示例 | 说明 |
|---------|---------|---------|------|
| 描述性文字 | 适配主卧面积 | 18㎡ | 必须是具体数值 |
| 模糊数值 | 约30㎡ | 30㎡ | 不能使用"约" |
| 括号说明 | 格力 KFR-35GW（推荐） | 格力 KFR-35GW | 不能添加括号 |
| 相对描述 | 根据客厅大小 | 15㎡ | 必须是绝对数值 |
| 建议词汇 | 建议1台 | 1台 | 只写数据 |
| 可选方案 | 1台或2台 | 1台 | 只写确定方案 |
| 范围描述 | 15-18㎡ | 18㎡ | 只写确定值 |
| 待定标记 | 待定 | 18㎡ | 必须确定 |

---

## 验证标准

### 自检清单

**表格完成后，逐项检查**：

- [ ] 每个单元格都是具体数据
- [ ] 没有"适配"、"约"、"根据"等词
- [ ] 没有括号说明
- [ ] 没有"推荐"、"建议"等词
- [ ] 面积都是具体数值+单位
- [ ] 型号都是完整的产品型号
- [ ] 价格都是具体金额
- [ ] 所有说明都在表格外

### 验证方法

**方法1：表头对照法**
```
逐列检查，每个单元格是否符合表头要求
表头：房间面积
检查：是否是"XX㎡"格式？
```

**方法2：数据类型法**
```
检查每个单元格的内容类型
应该是：数值、型号、价格
不应该是：描述、说明、建议
```

**方法3：关键词排查法**
```
搜索表格中是否包含：
- "适配"、"约"、"根据"
- "推荐"、"建议"、"可选"
- 括号"（）"
如有，立即修正
```

---

## 最佳实践

### 对AI的要求

**1. 理解表格本质**
- 表格是数据展示工具
- 不是文字描述工具
- 每个单元格对应一个数据点

**2. 严格按表头填写**
- 表头定义了数据类型
- 单元格必须符合表头要求
- 不能自由发挥

**3. 说明放在外面**
- 表格内只有数据
- 说明、备注、建议都放表格外
- 保持表格简洁

### 对用户的建议

**1. 检查表格数据**
- 查看是否有描述性文字
- 确认数据是否具体
- 验证数据是否合理

**2. 反馈问题**
- 如发现"适配XX"等文字，及时反馈
- 要求AI提供具体数据
- 说明需要看到确定的数值

**3. 理解表格结构**
- 表格内是数据
- 表格外是说明
- 两者配合使用

---

## 效果对比

### 优化前

**表格示例**：
```markdown
| 房间名称 | 房间面积 | 空调型号 | 数量 |
|---------|---------|---------|------|
| 主卧 | 适配主卧面积 | 格力 KFR-35GW | 1台 |
| 次卧 | 根据实际 | 格力 KFR-26GW | 根据需求 |
| 客厅 | 约30㎡ | 格力系列（推荐） | 1-2台 |
```

**问题**：
- ❌ 无法获取具体面积
- ❌ 数量不确定
- ❌ 型号不明确
- ❌ 表格失去意义

### 优化后

**表格示例**：
```markdown
| 房间名称 | 房间面积 | 空调型号 | 数量 |
|---------|---------|---------|------|
| 主卧 | 18㎡ | 格力 KFR-35GW | 1台 |
| 次卧 | 15㎡ | 格力 KFR-26GW | 1台 |
| 客厅 | 30㎡ | 格力 KFR-72LW | 1台 |

**方案说明**：
- 主卧18㎡，适合使用1.5匹空调
- 次卧15㎡，1匹空调足够
- 客厅30㎡，建议使用3匹空调，如需更强制冷可选2台1.5匹
```

**优势**：
- ✅ 所有数据具体明确
- ✅ 表格简洁清晰
- ✅ 说明独立展示
- ✅ 用户可以准确判断

---

## 总结

### 核心改进

1. **明确每列规范** 📋
   - 逐列定义填写要求
   - 提供正确和错误示例
   - 确保AI理解准确

2. **强化禁止内容** 🚫
   - 明确列出禁止词汇
   - 提供具体错误示例
   - 防止类似问题再现

3. **系统提示强化** 💪
   - 在系统角色中强调
   - 标注"严格执行"
   - 提高执行优先级

4. **示例对比教学** 📚
   - 正确示例
   - 错误示例
   - 对比说明

### 关键价值

- ✅ **数据准确性**：表格只包含具体数据
- ✅ **格式规范性**：严格按照表头要求
- ✅ **信息清晰性**：数据和说明分离
- ✅ **用户体验**：易于阅读和理解

### 技术亮点

- 🎯 **逐列规范**：每列都有明确要求
- 📊 **示例对照**：正确和错误对比
- 🚫 **禁止列表**：明确不能使用的内容
- 💡 **原则说明**：解释为什么这样要求

### 预期效果

- ✅ 不再出现"适配主卧面积"等描述
- ✅ 所有单元格都是具体数据
- ✅ 表格简洁清晰，易于阅读
- ✅ 用户可以准确获取信息

---

**修复完成时间**: 2024-12-27
**状态**: ✅ 完成并测试通过
**代码质量**: ✅ 所有检查通过
**效果**: ✅ 表格格式规范，数据准确
**用户反馈**: 等待实际使用验证
